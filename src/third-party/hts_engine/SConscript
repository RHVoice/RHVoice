# -*- mode: Python; indent-tabs-mode: t; tab-width: 4; python-indent: 4 -*-
# Copyright (C) 2013  Olga Yakovleva <yakovleva.o.v@gmail.com>

# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.

# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.

Import("env", "libquestion_match", "libfilter_manager")
local_env=env.Clone()
local_env["liblevel"]=1
local_env["libversion"]="1.06.0"
src=Glob("HTS_*.c")
if local_env["enable_mage"]:
    src.extend(Glob("HTS106_*.c"))

if "gcc" in env["TOOLS"] or "clang" in env["TOOLS"]:
    local_env.Prepend(LIBS=["m"])

local_env.Prepend(LIBS=[local_env["libquestion_match"],local_env["libfilter_manager"]])
local_env.Append(CPPDEFINES=['AUDIO_PLAY_NONE=1'])
libhts_engine=local_env.BuildLibrary("hts_engine",src)
local_env.Append(CPPDEFINES=["HTS_EXPORTS=1"])
local_env.Depends(libhts_engine,[libquestion_match,libfilter_manager])

if env["PLATFORM"]!="win32":
    local_env.InstallLibrary(libhts_engine)

Export("libhts_engine")
